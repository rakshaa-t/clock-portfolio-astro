<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Kindle — Books I'm Loving</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
:root{
  --bg:#E4E0DA;
  --text-primary:#3A3632;
  --text-secondary:#68635C;
  --text-muted:#807A72;
  --accent:#6B5CA8;
  --eink:#F3EFE6;
  --eink-dark:rgba(0,0,0,0.7);
}
html,body{
  margin:0;padding:0;background:var(--bg);color:var(--text-primary);
  font-family:'Geist',-apple-system,BlinkMacSystemFont,sans-serif;
  -webkit-font-smoothing:antialiased;
  min-height:100vh;display:flex;align-items:center;justify-content:center;
  padding:40px 20px;
}

.section-label{
  font-family:'Geist Mono',monospace;font-size:10px;font-weight:600;
  letter-spacing:0.12em;text-transform:uppercase;
  color:var(--text-muted);text-align:center;margin-bottom:20px;
}

/* ═══ KINDLE DEVICE ═══ */
.kindle-device{
  width:520px;position:relative;
  background:#1C1C1E;
  border-radius:24px;
  /* Thinner bezels — screen closer to edges, more bottom for brand */
  padding:18px 18px 42px;
  box-shadow:
    /* Outer drop shadow — device floating */
    0 20px 60px rgba(0,0,0,0.22),
    0 4px 12px rgba(0,0,0,0.15),
    /* Outer rim highlight — catches light */
    0 0 0 0.5px rgba(255,255,255,0.06),
    /* Inner edge highlights — rounded bezel catch */
    inset 0 1px 0 rgba(255,255,255,0.06),
    inset 0 -1px 0 rgba(0,0,0,0.4);
  /* Soft-touch matte body with subtle grain */
  background-image:
    /* Ambient light catch — top-left */
    radial-gradient(ellipse at 25% 15%,rgba(255,255,255,0.04),transparent 50%),
    /* Secondary highlight — center-right */
    radial-gradient(ellipse at 75% 40%,rgba(255,255,255,0.015),transparent 40%),
    /* Base gradient — slight depth */
    linear-gradient(175deg,#232325 0%,#1C1C1E 40%,#161618 100%);
  /* Soft-touch rubber texture via noise-like pattern */
  background-blend-mode:normal;
}
/* Soft-touch texture overlay */
.kindle-device::before{
  content:'';position:absolute;inset:0;border-radius:24px;
  background-image:
    radial-gradient(circle at 50% 50%,rgba(255,255,255,0.008) 1px,transparent 1px);
  background-size:3px 3px;
  pointer-events:none;z-index:0;
}

/* Power button — bottom edge, offset right like real Kindle */
.kindle-power{
  position:absolute;bottom:0;right:38%;
  transform:translateY(50%);
  width:28px;height:6px;border-radius:3px;
  background:linear-gradient(to bottom,#2A2A2C,#1E1E20);
  box-shadow:
    0 1px 2px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(255,255,255,0.06),
    0 0 0 0.5px rgba(0,0,0,0.3);
}

/* USB-C port — bottom center */
.kindle-usbc{
  position:absolute;bottom:0;left:50%;
  transform:translate(-50%,50%);
  width:14px;height:5px;border-radius:2px;
  background:#111;
  box-shadow:inset 0 1px 1px rgba(0,0,0,0.5),0 0 0 0.5px rgba(0,0,0,0.3);
}

/* "kindle" wordmark — lower bezel */
.kindle-brand{
  position:absolute;bottom:13px;left:50%;transform:translateX(-50%);
  font-family:'Geist',sans-serif;font-size:13px;font-weight:500;
  letter-spacing:0.28em;text-transform:lowercase;
  color:rgba(255,255,255,0.18);
  /* Subtle deboss effect */
  text-shadow:0 -1px 0 rgba(0,0,0,0.3),0 1px 0 rgba(255,255,255,0.03);
  user-select:none;
}

/* ═══ E-INK SCREEN ═══ */
.kindle-screen{
  width:100%;aspect-ratio:3/4;
  background:var(--eink);
  /* Flush display with rounded corners like 2024 Paperwhite */
  border-radius:10px;
  position:relative;overflow:hidden;
  /* E-ink paper texture — layered grain */
  background-image:
    repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.006) 2px,rgba(0,0,0,0.006) 3px),
    repeating-linear-gradient(90deg,transparent,transparent 3px,rgba(0,0,0,0.004) 3px,rgba(0,0,0,0.004) 4px);
  z-index:1;
}
/* Screen bezel shadow — flush-mounted display effect */
.kindle-screen::before{
  content:'';position:absolute;inset:0;border-radius:10px;
  box-shadow:
    inset 0 1px 4px rgba(0,0,0,0.08),
    inset 0 0 2px rgba(0,0,0,0.04),
    inset 0 0 0 0.5px rgba(0,0,0,0.08);
  pointer-events:none;z-index:5;
}

/* ═══ VIEW LAYER — both views stack, toggle visibility ═══ */
.kindle-view{
  position:absolute;inset:0;
  transition:opacity 0.3s ease, transform 0.3s ease;
}
.kindle-view.hidden{
  opacity:0;pointer-events:none;
  transform:translateX(8px);
}

/* ═══ TOP BAR ═══ */
.kindle-topbar{
  display:flex;align-items:center;gap:8px;
  padding:14px 18px 10px;
  border-bottom:1px solid rgba(0,0,0,0.06);
}
.kindle-back{
  width:28px;height:28px;border-radius:6px;
  background:none;border:none;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  color:rgba(0,0,0,0.5);font-size:16px;
  transition:background 0.15s ease;
}
.kindle-back:hover{background:rgba(0,0,0,0.06);}
.kindle-topbar-title{
  font-family:'Geist',sans-serif;font-size:13px;font-weight:600;
  color:rgba(0,0,0,0.6);letter-spacing:-0.01em;
}

/* ═══ LIBRARY VIEW ═══ */
.kindle-library{
  padding:0 18px 18px;
  overflow-y:auto;
  height:calc(100% - 53px);
}
.kindle-library::-webkit-scrollbar{width:3px;}
.kindle-library::-webkit-scrollbar-track{background:transparent;}
.kindle-library::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.12);border-radius:3px;}

.kindle-grid{
  columns:3;
  column-gap:14px;
  padding-top:14px;
}
.kindle-grid-book{
  cursor:pointer;
  break-inside:avoid;
  margin-bottom:14px;
  transition:transform 0.2s ease, opacity 0.2s ease;
}
.kindle-grid-book:hover{transform:scale(1.03);}
.kindle-grid-book:active{transform:scale(0.97);}
.kindle-grid-cover{
  width:100%;
  border-radius:4px;
  display:flex;flex-direction:column;
  justify-content:flex-end;padding:10px;
  position:relative;overflow:hidden;
  box-shadow:1px 2px 6px rgba(0,0,0,0.15);
}
.kindle-grid-cover img{
  width:100%;display:block;border-radius:4px;
}
/* Fallback colored covers (no image) — ratio set inline per book */
.kindle-grid-cover::before{
  content:'';position:absolute;left:0;top:0;width:3px;height:100%;
  background:linear-gradient(to right,rgba(0,0,0,0.2),transparent);
  z-index:2;
}
.kindle-grid-cover::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(180deg,transparent 50%,rgba(0,0,0,0.3) 100%);
  z-index:1;
}
.kindle-grid-title{
  font-family:'Geist',sans-serif;font-size:10px;font-weight:600;
  color:white;line-height:1.3;position:relative;z-index:1;
  text-shadow:0 1px 2px rgba(0,0,0,0.4);
}
.kindle-grid-author{
  font-family:'Geist Mono',monospace;font-size:7px;
  color:rgba(255,255,255,0.6);margin-top:2px;
  position:relative;z-index:1;letter-spacing:0.02em;
}
/* Progress dot on grid covers */
.kindle-grid-progress{
  position:absolute;top:6px;right:6px;z-index:2;
  width:6px;height:6px;border-radius:50%;
  background:rgba(0,0,0,0.2);
}
.kindle-grid-progress.reading{background:rgba(107,92,168,0.7);}
.kindle-grid-progress.finished{background:rgba(45,106,79,0.7);}

/* ═══ BOOK DETAIL VIEW ═══ */
.kindle-detail{
  padding:0 24px 24px;
  overflow-y:auto;
  height:calc(100% - 53px);
}
.kindle-detail::-webkit-scrollbar{width:3px;}
.kindle-detail::-webkit-scrollbar-track{background:transparent;}
.kindle-detail::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.12);border-radius:3px;}

.kindle-detail-cover{
  width:55%;margin:20px auto 24px;
  border-radius:5px;
  position:relative;overflow:hidden;
  box-shadow:2px 4px 16px rgba(0,0,0,0.2);
}
.kindle-detail-cover img{
  width:100%;display:block;border-radius:5px;
}
.kindle-detail-cover.no-img{
  aspect-ratio:2/3;
  display:flex;flex-direction:column;
  justify-content:flex-end;padding:20px;
}
.kindle-detail-cover::before{
  content:'';position:absolute;left:0;top:0;width:4px;height:100%;
  background:linear-gradient(to right,rgba(0,0,0,0.2),transparent);
  z-index:2;
}
.kindle-detail-title{
  font-family:'Geist',sans-serif;font-size:18px;font-weight:600;
  color:white;line-height:1.3;position:relative;z-index:1;
  text-shadow:0 1px 3px rgba(0,0,0,0.4);margin-bottom:4px;
}
.kindle-detail-author{
  font-family:'Geist Mono',monospace;font-size:10px;
  color:rgba(255,255,255,0.65);letter-spacing:0.04em;
  position:relative;z-index:1;
}

/* Meta info */
.kindle-detail-meta{
  text-align:center;margin-bottom:20px;
}
.kindle-detail-subtitle{
  font-family:'Geist',sans-serif;font-size:14px;font-weight:500;
  color:rgba(0,0,0,0.6);margin-bottom:4px;
}
.kindle-detail-by{
  font-family:'Geist Mono',monospace;font-size:10px;
  color:rgba(0,0,0,0.35);letter-spacing:0.04em;
}

/* Progress bar */
.kindle-detail-progress-wrap{
  margin-bottom:20px;
}
.kindle-detail-progress-label{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:6px;
}
.kindle-detail-progress-text{
  font-family:'Geist Mono',monospace;font-size:10px;font-weight:600;
  color:rgba(0,0,0,0.4);letter-spacing:0.04em;
}
.kindle-detail-progress-pct{
  font-family:'Geist Mono',monospace;font-size:12px;font-weight:700;
  color:rgba(0,0,0,0.55);
}
.kindle-detail-progress-bar{
  height:4px;background:rgba(0,0,0,0.08);border-radius:2px;overflow:hidden;
}
.kindle-detail-progress-fill{
  height:100%;border-radius:2px;
  background:rgba(0,0,0,0.3);
  transition:width 0.5s cubic-bezier(0.32,0.72,0,1);
}

/* Notes toggle */
.kindle-detail-notes-btn{
  display:flex;align-items:center;justify-content:center;gap:6px;
  width:100%;padding:10px;border-radius:8px;
  background:rgba(0,0,0,0.04);border:1px solid rgba(0,0,0,0.06);
  cursor:pointer;
  font-family:'Geist Mono',monospace;font-size:10px;font-weight:600;
  letter-spacing:0.06em;text-transform:uppercase;
  color:rgba(0,0,0,0.4);
  transition:all 0.2s ease;
}
.kindle-detail-notes-btn:hover{
  background:rgba(0,0,0,0.06);color:rgba(0,0,0,0.55);
}
.kindle-detail-notes-btn.active{
  background:rgba(107,92,168,0.12);color:rgba(107,92,168,0.75);
  border-color:rgba(107,92,168,0.25);
}
.kindle-detail-notes-btn svg{flex-shrink:0;}

/* Bottom drawer */
.kindle-drawer-overlay{
  position:absolute;inset:0;z-index:10;
  background:rgba(0,0,0,0);
  pointer-events:none;
  transition:background 0.3s ease;
}
.kindle-drawer-overlay.open{
  background:rgba(0,0,0,0.15);
  pointer-events:auto;
}
.kindle-drawer{
  position:absolute;bottom:0;left:0;right:0;z-index:11;
  background:var(--eink);
  border-radius:14px 14px 0 0;
  box-shadow:0 -4px 20px rgba(0,0,0,0.1);
  transform:translateY(100%);
  transition:transform 0.35s cubic-bezier(0.32,0.72,0,1);
  max-height:70%;
  display:flex;flex-direction:column;
}
.kindle-drawer.open{
  transform:translateY(0);
}
.kindle-drawer-handle{
  width:32px;height:4px;border-radius:2px;
  background:rgba(0,0,0,0.15);
  margin:10px auto 0;flex-shrink:0;
}
.kindle-drawer-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:12px 18px 10px;
  border-bottom:1px solid rgba(0,0,0,0.06);
  flex-shrink:0;
}
.kindle-drawer-title{
  font-family:'Geist Mono',monospace;font-size:10px;font-weight:600;
  letter-spacing:0.1em;text-transform:uppercase;
  color:rgba(0,0,0,0.4);
  display:flex;align-items:center;gap:6px;
}
.kindle-drawer-title::before{
  content:'';width:10px;height:10px;border-radius:2px;
  background:linear-gradient(135deg,#B8ADE0,#8B7EC8);
  flex-shrink:0;
}
.kindle-drawer-close{
  width:24px;height:24px;border-radius:6px;
  background:none;border:none;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  color:rgba(0,0,0,0.35);font-size:14px;
  transition:background 0.15s ease;
}
.kindle-drawer-close:hover{background:rgba(0,0,0,0.06);}
.kindle-drawer-content{
  padding:14px 18px 20px;
  overflow-y:auto;flex:1;
}
.kindle-drawer-content::-webkit-scrollbar{width:3px;}
.kindle-drawer-content::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.1);border-radius:3px;}
.kindle-highlight{
  margin-bottom:14px;padding-bottom:14px;
  border-bottom:1px solid rgba(0,0,0,0.05);
}
.kindle-highlight:last-child{margin-bottom:0;padding-bottom:0;border-bottom:none;}
.kindle-highlight-bar{
  font-family:'Geist',sans-serif;font-size:12px;line-height:1.55;
  color:var(--text-primary);
  background:linear-gradient(180deg,rgba(139,126,200,0.2) 0%,rgba(139,126,200,0.08) 100%);
  border-left:2px solid #8B7EC8;
  padding:8px 10px;border-radius:0 4px 4px 0;
  margin-bottom:6px;
}
.kindle-highlight-note{
  font-family:'Geist',sans-serif;font-size:11px;line-height:1.5;
  color:var(--text-secondary);font-style:italic;
  padding-left:12px;
}
.kindle-no-notes{
  font-family:'Geist',sans-serif;font-size:11px;
  color:rgba(0,0,0,0.3);font-style:italic;
  text-align:center;padding:12px 0;
}

/* ═══ MOBILE ═══ */
@media(max-width:560px){
  .kindle-device{width:100%;border-radius:18px;padding:14px 14px 36px;}
  .kindle-brand{font-size:11px;bottom:11px;}
  .kindle-screen{border-radius:8px;}
  .kindle-screen::before{border-radius:8px;}
  .kindle-grid{columns:2;column-gap:10px;}
  .kindle-grid-title{font-size:9px;}
  .kindle-detail-cover{width:65%;}
}
</style>
</head>
<body>

<div>
  <div class="section-label">Books I'm loving</div>
  <div class="kindle-device">
    <div class="kindle-screen">

      <!-- LIBRARY VIEW -->
      <div class="kindle-view" id="libraryView">
        <div class="kindle-topbar">
          <span class="kindle-topbar-title">Library</span>
        </div>
        <div class="kindle-library">
          <div class="kindle-grid" id="kindleGrid"></div>
        </div>
      </div>

      <!-- BOOK DETAIL VIEW -->
      <div class="kindle-view hidden" id="detailView">
        <div class="kindle-topbar">
          <button class="kindle-back" id="backBtn">←</button>
          <span class="kindle-topbar-title" id="detailTopTitle">Book</span>
        </div>
        <div class="kindle-detail">
          <div class="kindle-detail-cover" id="detailCover">
            <div class="kindle-detail-title" id="detailTitle"></div>
            <div class="kindle-detail-author" id="detailAuthor"></div>
          </div>
          <div class="kindle-detail-meta">
            <div class="kindle-detail-subtitle" id="detailSubtitle"></div>
            <div class="kindle-detail-by" id="detailBy"></div>
          </div>
          <div class="kindle-detail-progress-wrap">
            <div class="kindle-detail-progress-label">
              <span class="kindle-detail-progress-text">Progress</span>
              <span class="kindle-detail-progress-pct" id="detailPct">0%</span>
            </div>
            <div class="kindle-detail-progress-bar">
              <div class="kindle-detail-progress-fill" id="detailFill" style="width:0%"></div>
            </div>
          </div>
          <button class="kindle-detail-notes-btn" id="notesBtn">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
              <rect x="1" y="2.5" width="12" height="2" rx="0.5" fill="currentColor" opacity="0.6"/>
              <rect x="1" y="6" width="8" height="2" rx="0.5" fill="currentColor" opacity="0.4"/>
              <rect x="1" y="9.5" width="5" height="2" rx="0.5" fill="currentColor" opacity="0.25"/>
            </svg>
            My highlights
          </button>
        </div>
      </div>

      <!-- NOTES DRAWER -->
      <div class="kindle-drawer-overlay" id="drawerOverlay"></div>
      <div class="kindle-drawer" id="notesDrawer">
        <div class="kindle-drawer-handle"></div>
        <div class="kindle-drawer-header">
          <span class="kindle-drawer-title">My highlights</span>
          <button class="kindle-drawer-close" id="drawerClose">✕</button>
        </div>
        <div class="kindle-drawer-content" id="drawerContent"></div>
      </div>

    </div>
    <div class="kindle-power"></div>
    <div class="kindle-usbc"></div>
    <div class="kindle-brand">kindle</div>
  </div>
</div>

<script>
const BOOKS=[
  {title:"The Art of Doing Science and Engineering",author:"Richard Hamming",subtitle:"Learning to Learn",color:"linear-gradient(135deg,#2C3E50,#4A6274)",ratio:"2/3.2",progress:72,notes:[
    {highlight:"The purpose of computing is insight, not numbers.",note:"This changed how I think about dashboards — am I showing data or enabling decisions?"},
    {highlight:"You get what you measure.",note:"Applies to design too. If you only measure clicks, you'll design clickbait."}
  ]},
  {title:"Siddhartha",author:"Hermann Hesse",subtitle:"A Novel",color:"linear-gradient(135deg,#8E6B3E,#C4956A)",ratio:"2/2.8",progress:100,notes:[
    {highlight:"Knowledge can be communicated, but not wisdom.",note:"The gap between knowing design principles and having taste. Can't shortcut it."},
    {highlight:"The river is everywhere at the same time.",note:"Flow state feels exactly like this — past and future collapse into now."}
  ]},
  {title:"Grid Systems in Graphic Design",author:"Josef Müller-Brockmann",subtitle:"Visual Communication",color:"linear-gradient(135deg,#1A1A2E,#3A3A5C)",ratio:"2/2.5",progress:45,notes:[
    {highlight:"The grid system is an aid, not a guarantee.",note:"Grids are scaffolding, not the building. Break them intentionally."},
    {highlight:"Integral design means every element relates to every other.",note:"Why I obsess over spacing systems — everything has to rhyme."}
  ]},
  {title:"Refactoring UI",author:"Wathan & Schoger",subtitle:"Design for Developers",color:"linear-gradient(135deg,#4A2F6B,#7B52A0)",ratio:"2/2.6",progress:88,notes:[
    {highlight:"Good design is as little design as possible.",note:"My north star. If I can remove it and nothing breaks, it shouldn't be there."},
    {highlight:"Start with too much whitespace, then add elements.",note:"Counterintuitive but it works every time. Empty space is the design."}
  ]},
  {title:"The Gene",author:"Siddhartha Mukherjee",subtitle:"An Intimate History",color:"linear-gradient(135deg,#1B4332,#2D6A4F)",ratio:"2/3",progress:31,notes:[
    {highlight:"A gene is a long word written in the letters of the DNA alphabet.",note:"Beautiful metaphor. Design is also encoding — we write in pixels and motion."},
    {highlight:"We inherit not just genes but the silence between them.",note:"The negative space in genetics. Same principle in typography."}
  ]},
  {title:"Thinking, Fast and Slow",author:"Daniel Kahneman",subtitle:"Psychology",color:"linear-gradient(135deg,#4A4E69,#6B7094)",ratio:"2/3.1",progress:62,notes:[
    {highlight:"Nothing in life is as important as you think it is while you are thinking about it.",note:"Design reviews in a nutshell. Sleep on it."}
  ]},
  {title:"The Design of Everyday Things",author:"Don Norman",subtitle:"Human-Centered Design",color:"linear-gradient(135deg,#B85C3A,#D4845F)",ratio:"2/2.7",progress:100,notes:[
    {highlight:"Design is really an act of communication.",note:"Every pixel is a word. Every animation is tone of voice."},
    {highlight:"When you have trouble with things, it's not your fault. It's bad design.",note:"My mantra when doing usability testing."}
  ]},
  {title:"Sapiens",author:"Yuval Noah Harari",subtitle:"A Brief History of Humankind",color:"linear-gradient(135deg,#8B6914,#C49B2A)",ratio:"2/3.3",progress:55,notes:[]},
  {title:"Atomic Habits",author:"James Clear",subtitle:"Tiny Changes, Remarkable Results",color:"linear-gradient(135deg,#1A3A5C,#2A5A8C)",ratio:"2/2.9",progress:100,notes:[
    {highlight:"You do not rise to the level of your goals. You fall to the level of your systems.",note:"This is why I build rituals around my creative practice, not just set targets."}
  ]},
  {title:"Reality Transurfing",author:"Vadim Zeland",subtitle:"Steps I-V",color:"linear-gradient(135deg,#3A1A5C,#6A3A8C)",ratio:"2/3.4",progress:40,notes:[
    {highlight:"The world is a mirror of your attitude toward it.",note:"Designing from abundance vs scarcity produces completely different work."}
  ]},
  {title:"Steal Like an Artist",author:"Austin Kleon",subtitle:"Creative Advice",color:"linear-gradient(135deg,#2C2C2C,#4A4A4A)",ratio:"2/2.4",progress:100,notes:[]},
  {title:"Breaking the Habit of Being Yourself",author:"Joe Dispenza",subtitle:"How to Lose Your Mind",color:"linear-gradient(135deg,#1A4A3A,#2A7A5A)",ratio:"2/3.1",progress:85,notes:[
    {highlight:"Your thoughts are incredibly powerful. Choose yours wisely.",note:"Morning meditation before design work = completely different output quality."}
  ]},
];

const grid=document.getElementById('kindleGrid');
const libraryView=document.getElementById('libraryView');
const detailView=document.getElementById('detailView');
const backBtn=document.getElementById('backBtn');
const notesBtn=document.getElementById('notesBtn');
const notesDrawer=document.getElementById('notesDrawer');
const drawerOverlay=document.getElementById('drawerOverlay');
const drawerClose=document.getElementById('drawerClose');
const drawerContent=document.getElementById('drawerContent');

// Render library grid
BOOKS.forEach((book,i)=>{
  const el=document.createElement('div');
  el.className='kindle-grid-book';
  const status=book.progress>=100?'finished':book.progress>0?'reading':'';
  const hasImg=!!book.cover;

  let coverInner='';
  if(hasImg){
    coverInner=`<img src="${book.cover}" alt="${book.title}">`;
  }else{
    coverInner=`
      <div class="kindle-grid-title">${book.title}</div>
      <div class="kindle-grid-author">${book.author}</div>`;
  }

  el.innerHTML=`
    <div class="kindle-grid-cover ${hasImg?'':'no-img'}" style="${hasImg?'':('background:'+book.color+';aspect-ratio:'+book.ratio)}">
      <div class="kindle-grid-progress ${status}"></div>
      ${coverInner}
    </div>`;
  el.addEventListener('click',()=>openBook(i));
  grid.appendChild(el);
});

function openBook(i){
  const book=BOOKS[i];
  const cover=document.getElementById('detailCover');
  document.getElementById('detailTopTitle').textContent=book.title.length>30?book.title.substring(0,30)+'…':book.title;

  if(book.cover){
    cover.className='kindle-detail-cover';
    cover.style.background='';
    cover.innerHTML=`<img src="${book.cover}" alt="${book.title}">`;
  }else{
    cover.className='kindle-detail-cover no-img';
    cover.style.background=book.color;
    cover.innerHTML=`
      <div class="kindle-detail-title">${book.title}</div>
      <div class="kindle-detail-author">${book.author}</div>`;
  }

  document.getElementById('detailSubtitle').textContent=book.subtitle;
  document.getElementById('detailBy').textContent='by '+book.author;
  document.getElementById('detailPct').textContent=book.progress+'%';
  document.getElementById('detailFill').style.width=book.progress+'%';

  // Render notes into drawer
  if(book.notes&&book.notes.length>0){
    drawerContent.innerHTML=book.notes.map(n=>
      `<div class="kindle-highlight">
        <div class="kindle-highlight-bar">${n.highlight}</div>
        <div class="kindle-highlight-note">${n.note}</div>
      </div>`).join('');
  }else{
    drawerContent.innerHTML='<div class="kindle-no-notes">No highlights yet</div>';
  }

  // Reset drawer state
  notesDrawer.classList.remove('open');
  drawerOverlay.classList.remove('open');
  notesBtn.classList.remove('active');

  // Transition
  libraryView.classList.add('hidden');
  detailView.classList.remove('hidden');
}

backBtn.addEventListener('click',()=>{
  closeDrawer();
  detailView.classList.add('hidden');
  libraryView.classList.remove('hidden');
});

function openDrawer(){
  notesDrawer.classList.add('open');
  drawerOverlay.classList.add('open');
  notesBtn.classList.add('active');
}
function closeDrawer(){
  notesDrawer.classList.remove('open');
  drawerOverlay.classList.remove('open');
  notesBtn.classList.remove('active');
}

notesBtn.addEventListener('click',()=>{
  if(notesDrawer.classList.contains('open')) closeDrawer();
  else openDrawer();
});

drawerClose.addEventListener('click',closeDrawer);
drawerOverlay.addEventListener('click',closeDrawer);
</script>
</body>
</html>
